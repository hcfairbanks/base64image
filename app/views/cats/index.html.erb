<p id="notice"><%= notice %></p>

<h1>Cats</h1>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Picture</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @cats.each do |cat| %>
      <tr>
        <td><%= cat.name %></td>
        <td><%= cat.picture %></td>
        <td><%= link_to 'Show', cat %></td>
        <td><%= link_to 'Edit', edit_cat_path(cat) %></td>
        <td><%= link_to 'Destroy', cat, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New cat', new_cat_path %>
<script>
  function send_docs(e){
    var reader = new FileReader()
    var files = document.getElementById('picture').files;
    var reader = new FileReader();
    reader.readAsDataURL(files[0]);

    reader.onload = function () {
      base64string = reader.result
      console.log(base64string);
      info = {cat:{
               name: "Mr Furry Bottom",
               picture: base64string
             }};

      $.ajax({
          url: "http://localhost:3000/cats/",
          type: "POST",
          dataType: "JSON",
          data: info,
          success: function (response) {
          //  alert(response);
          }
      });

    }; //End of encoding

  };
</script>


<form onsubmit="return send_docs(this)">
  <input type="file" name="file" id="picture">
  <input type="submit">
</form>
